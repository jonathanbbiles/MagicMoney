ALPACA_API_KEY=YOUR_ALPACA_API_KEY
ALPACA_SECRET_KEY=YOUR_ALPACA_SECRET_KEY
ALPACA_API_BASE=https://api.alpaca.markets/v2
API_TOKEN=CHANGE_ME_TO_A_LONG_RANDOM_STRING
CORS_ALLOWED_ORIGINS=http://localhost:19006,http://localhost:8081
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=120
# === Exits & Risk ===
EXIT_POLICY_LOCKED=true         # lock exit policy to GTC TP-only flow
EXIT_MODE=net_after_fees        # enforced when EXIT_POLICY_LOCKED=true
EXIT_NET_PROFIT_AFTER_FEES_BPS=5 # target net-after-fees profit (0.05%)
EXIT_CANCELS_ENABLED=false      # do not cancel TP/exit sells during normal operation
SELL_REPRICE_ENABLED=false      # disable TP cancel/replace repricing
EXIT_TAKER_ON_TOUCH_ENABLED=false # disable taker-on-touch exits
EXIT_MARKET_EXITS_ENABLED=false # disable stop-loss/timeout/max-hold market exits
DISABLE_IOC_EXITS=true           # true = use MARKET sell instead of IOC/limit exits (prevents canceled limit sell noise)
EXIT_LIMIT_SELL_TIF=gtc          # used only when DISABLE_IOC_EXITS=false; gtc rests, ioc cancels if not immediately filled
EXIT_ORDER_CLASS=limit          # "limit" => TP-only without OCO stop-loss
STOP_LOSS_BPS=0                 # stop loss distance from entry, in basis points (0.00%)
STOP_LIMIT_OFFSET_BPS=10        # stop-limit is an extra 0.10% below the stop price
DESIRED_NET_PROFIT_BASIS_POINTS=100 # target net profit per trade after fees (1.00%); tune so gross stays ~60-150 bps after fees
# EXIT_NET_PROFIT_AFTER_FEES_BPS=5  # only used when EXIT_MODE=net_after_fees
EXIT_SPREAD_AWARE_ENABLED=true      # if true, widen exit target based on live spread
EXIT_SPREAD_BPS_MULTIPLIER=1.0      # multiplier applied to spread bps when adjusting exit target
EXIT_SPREAD_BPS_ADD=0               # additive bps applied after spread multiplier
EXIT_SPREAD_BPS_CAP=250             # cap spread bps input for adjustments
EXIT_SPREAD_BPS_FLOOR=0             # floor spread bps input for adjustments
MAX_GROSS_TAKE_PROFIT_BASIS_POINTS=150 # cap gross take-profit distance above entry (1.50%)
MIN_GROSS_TAKE_PROFIT_BASIS_POINTS=60  # floor gross take-profit distance above entry (0.60%)
# Exits can tolerate older quotes than entries
EXIT_QUOTE_MAX_AGE_MS=120000
# Optional stricter threshold (only used if you set it)
EXIT_STALE_QUOTE_MAX_AGE_MS=15000
EXIT_REPAIR_INTERVAL_MS=60000     # run orphan-exit repair at most once per minute
SELL_QTY_MATCH_EPSILON=1e-9       # qty tolerance when adopting existing TP sells
# Buy notional is pct of portfolio, capped by buying power.
TRADE_PORTFOLIO_PCT=0.10
# SIMPLE_SCALPER: fast spread-only entry mode (defaults OFF if missing; FULL mode is default)
SIMPLE_SCALPER=0
# Simple scalper spread gate (defaults to MAX_SPREAD_BPS_TO_TRADE if set, otherwise 60 bps)
MAX_SPREAD_BPS_SIMPLE=60
# Simple scalper TP target: net profit + fee estimate
PROFIT_NET_BPS=100
FEE_BPS_EST=25
# Optional reserve to hold back from buying power
BUYING_POWER_RESERVE_USD=0
# MIN_ORDER_NOTIONAL_USD is your bot's local gate (not Alpaca fees).
MIN_ORDER_NOTIONAL_USD=1        # minimum order size in USD
POST_ONLY_BUY=true              # if true, maker-friendly limit buys use post-only for crypto
POST_ONLY_SELL=false            # NOTE: TP/exit sells ignore this to avoid post-only cancellations (kept for legacy configs)
REPRICE_EVERY_SECONDS=5         # exit manager inspection cadence
SELL_ORDER_TTL_MS=12000         # how long before we replace/repost a TP
TAKER_EXIT_ON_TOUCH=false       # legacy env toggle (overridden by EXIT_TAKER_ON_TOUCH_ENABLED)
TAKER_TOUCH_MIN_INTERVAL_MS=5000 # min interval between taker-on-touch exits per symbol
ALLOW_TAKER_BEFORE_TARGET=false  # allow taker exits at breakeven before TP is reached
ENTRY_FILL_TIMEOUT_SECONDS=30    # seconds to wait for maker entry fill before cancel
ENTRY_INTENT_TTL_MS=45000        # cancel/replace entry intent orders older than this
ENTRY_FALLBACK_MARKET=false      # fallback to market entry if maker entry doesn't fill
MAX_HOLD_SECONDS=180             # soft max hold time before exiting if profitable
# FORCE_EXIT_SECONDS=0           # absolute max hold time before forced exit (disabled by default)
FORCE_EXIT_ALLOW_LOSS=false      # dangerous: only enable if you want forced exits at a loss
MAX_SPREAD_BPS_TO_TRADE=25       # skip entries if spread is wider than this
ENTRY_QUOTE_MAX_AGE_MS=60000     # max age for entry-side quotes (ms)
# ORDERBOOK_GUARD: improve entry decisions using depth/impact
ORDERBOOK_GUARD_ENABLED=true
ORDERBOOK_MAX_AGE_MS=3000
ORDERBOOK_BAND_BPS=10
ORDERBOOK_MIN_DEPTH_USD=250
ORDERBOOK_IMPACT_NOTIONAL_USD=100
ORDERBOOK_MAX_IMPACT_BPS=6
ORDERBOOK_IMBALANCE_BIAS_SCALE=0.04
HALT_ON_ORPHANS=false            # do not halt trading due to orphan detection
